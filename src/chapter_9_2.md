## 9.2 Bash History Builtins
Bash는 이력 리스트와 이력 파일을 다루기 위해 두 개의 빌트인 명령어를 제공합니다.

**fc**

```sh
fc [-e ename] [-lnr] [first] [last]
fc -s [pat=rep] [command]
```

첫번째 형식은 이력 리스트에서 *first*부터 *last*까지의 명령어를 선택해 출력하거나 편집하고 재실행합니다. *first*와 *last*는 문자열(해당 문자열로 시작하는 가장 최근의 명령어를 찾습니다)이나 숫자(이력 리스트의 인덱스. 음수는 현재 명령어 번호로부터의 오프셋으로 사용됩니다)를 지정할 수 있습니다.

리스트를 나열할 때, *first*나 *last*가 0이면 -1과 동일하고, -0은 현재 명령어와 동일합니다(일반적으로 `fc` 명령어). 그 이외의 경우에는 0은 -1과 동일하며 -0은 유효하지 않습니다.

*last*를 지정하지 않았다면 *first*의 값이 사용됩니다. *first*를 지정하지 않았다면 이전에 편집한 명령어 또는 리스트를 나열하는 경우에는 -16이 설정됩니다. `-l` 플래그를 넘겼다면 명령어는 표준 출력에 리스트를 나열합니다. `-n` 플래그는 리스트를 나열할 때 명령어 번호를 출력하지 않습니다. 그 이외의 경우에는 지정된 명령어 리스트를 포함하는 파일을 `ename`으로 지정된 에디터로 엽니다. *ename*이 지정되지 않았다면 `${FCEDIT:-${EDITOR:-vi}}`의 전개한 값을 사용합니다. 이는 `FCEDIT` 변수, `EDITOR` 변수를 순서대로 확인하고, 둘 다 설정되어 있지 않다면 `vi`를 사용한다는 의미입니다. 편집이 완료되면 편집된 명령어들을 출력하고 실행합니다.

두번째 형식에서 선택된 *command*의 *pat*의 각 인스턴스를 *rep*로 대체된 이후, 명령어를 재실행합니다. *command*는 위에서 본 *first*와 동일하게 처리됩니다.

`r='fc -s'`는 '`r cc`'를 입력하면 `cc`로 시작하는 마지막 명령어를 실행하고 `r`을 입력하면 마지막 명령어를 재실행하므로 `fc` 명령어를 사용할 때 유용한 별칭입니다.

**history**

```sh
history [n]
history -c
history -d offset
history -d start-end
history [-anrw] [filename]
history -ps arg
```

옵션 지정 없이 사용하면 이력 리스트는 줄 번호와 함께 출력합니다. '*'로 시작하면 줄이 변경되었다는 의미입니다. *n* 인수는 마지막 *n*개의 줄을 출력합니다. 셸 변수 `HISTTIMEFORMAT`에 널이 아닌 값이 설정되어 있다면 각 이력과 연결된 타임스탬프를 출력할 때 *stftime*의 형식 문자열로 사용됩니다. 형식화된 타임스탬프와 이력 줄 사이에는 공백 문자가 포함되지 않습니다.

넘긴 옵션은 다음의 의미를 가집니다.

- **-c**

  이력 리스트를 비웁니다. 다른 옵션과 조합해서 이력 리스트를 완전히 대체할 수 있습니다.
- **-d *offset***

  *offset*에 위치하는 이력을 지웁니다. *offset*이 양수라면 이력을 출력할 때 보이는 순서입니다. *offset*이 음수라면 마지막 이력 위치로부터 하나 큰 위치의 상대값으로 처리되므로, 음수 인덱스는 이력의 맨 끝으로부터 셉니다. 그러므로 인덱스 '-1'은 현재 `history -d` 명령어입니다.
- **-d *start-end***

  이력 리스트의 *start*번째 이력과 *end*번째 이력 사이에 있는 이력을 포괄적으로 삭제합니다. *start*와 *end*에 넘긴 양수와 음수는 각각 위에서 설명한 것과 동일하게 처리됩니다.
- **-a**

  새 이력을 이력 파일의 마지막에 추가합니다. 대상은 현재 Bash 세션이 시작된 이후로 입력된 줄이며, 단 아직 이력 파일에 추가되지는 않은 것들입니다.
- **-n**

  이력 파일로부터 아직 읽히지 않은 이력 줄을 현재 이력 리스트에 추가합니다. 대상은 현재 Bash 세션을 시작한 이후에 이력 파일에 추가된 줄입니다.
- **-r**

  이력 파일을 읽고 그 내용을 이력 리스트에 추가합니다.
- **-w**

  현재 이력 리스트를 이력 파일로 내보냅니다.
- **-p**

  *args`에 대해 이력 치환을 실행하고 결과를 표준 출력에 보여줍니다. 이 때 결과는 이력 리스트에 저장하지 않습니다.
- **-s**

  *args*를 이력 리스트의 마지막에 하나의 이력으로 추가합니다.

`-w`, `-r`, `-a`, `-n` 옵션을 사용하고 *filename*을 넘겼다면, 넘긴 파일이 이력 파일로 사용됩니다. 넘기지 않았다면 `HISTFILE` 변수의 값이 사용됩니다.
