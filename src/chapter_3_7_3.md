### 3.7.3 Command Execution Environment

셸은 *실행 환경*을 가지고 있으며, 이는 다음으로 구성되어 있습니다.

- 호출 시점에 셸에 의해서 열린 파일들을 상속합니다. 이들은 `exec` 빌트인 명령어에 제공된 리다이렉션에 의해 변경됩니다.
- `cd`, `pushd`, `popd`에 의해서 설정되거나 호출 시점에 셸로부터 상속된 현재 작업 디렉터리.
- `umask`나 셸의 부모로부터 상속된 파일 생성 모드 마스크 설정.
- `trap`에 의해서 설정된 현재 트랩.
- 변수 대입이나 `set`으로 설정되거나 셸의 부모의 환경으로부터 상속된 셸 매개변수.
- 실행중에 정의되거나 셸의 부모의 환경으로부터 상속된 셸 함수.
- 호출시 켠 옵션(기본값이나 실행시에 인수로 넘겨진 경우)이나 `set`으로 설정된 옵션.
- `shopt`로 켠 옵션([The Shopt Builtin](chapter_4_3_2.html)을 참조).
- `alias`로 정의된 셸 엘리아스([Aliases](chapter_6_6.html)를 참조).
- 다양한 프로세스 ID. 이는 백그라운드 잡([Lists of Commands](chapter_3_2_4.html)를 참조)과 `$$`의 값, `$PPID`의 값을 포함합니다.

셸 함수나 빌트인 명령어가 아닌 단순 명령어를 실행하는 경우, 다음으로 구성된 별도의 실행 환경에서 호출됩니다. 특별한 언급이 없는 한 값은 셸에서 상속됩니다.

- 셸이 연 파일들에 더해 명령어에 지정된 리다이렉션이 적용됩니다.
- 현재 작업 디렉터리.
- 파일 생성 모드 마스크.
- 익스포트할 셸 변수/함수와 명령어를 위해 부모로부터 환경으로 넘겨진 익스포트된 변수([Environment](chapter_3_7_4.html)를 참조).
- 잡도록 설정되어 있는 셸의 트랩을 부모로부터 상속된 값으로 초기화하며, 무시하도록 설정되어 있는 트랩은 그대로 무시합니다.

이 별도의 환경에서 실행된 명령어는 셸의 실행 환경에 영향을 줄 수 없습니다.

명령어 치환, 소괄호로 묶은 명령어 리스트, 비동기 명령어들은 서브셸 환경에서 호출되며, 이 환경은 셸의 트랩 설정이 호출 시점에 그 부모의 셸이 가지고 있는 값으로 재설정되는 점을 제외하면 셸의 환경의 복제판입니다. 파이프라인의 일부로 호출되는 빌트인 명령어 역시 서브셸 환경에서 실행됩니다. 서브셸 환경을 변경하는 것은 셸의 실행 환경에 영향을 줄 수 없습니다.

명령어 치환을 실행하기 위해서 생성되는 서브셸은 부모 셸로부터 `-e` 옵션의 값을 상속합니다. 만약 POSIX 모드가 아니라면, Bash는 서브셸에서 `-e` 옵션의 값을 지웁니다.

만약 명령어 뒤에 '&'가 존재하고, 잡 컨트롤이 활성화된 상태가 아니라면 명령어의 기본 표준 입력은 빈 파일인 `/dev/null`입니다. 그렇지 않다면, 호출된 명령어는 리다이렉션으로 변경된 셸의 파일 디스크립터를 상속합니다.
