### 4.3.2 The Shopt Builtin
이 빌트인으로 셸의 추가 행동 옵션을 변경할 수 있습니다.

**shopt**

```sh
shopt [-pqsu] [-o] [optname …]
```
셸의 추가 행동 옵션을 켜고 끌 수 있습니다. 사용 가능한 설정은 아래에서 볼 수 있습니다. `-o` 옵션을 사용하는 경우, 빌트인 명령어 `set`([The Set Builtin](chapter_4_3_1.html)을 참조)의 `-o` 옵션과 동일합니다. 옵션을 넘기지 않거나, `-p` 옵션을 넘긴다면 설정 가능한 모든 옵션과 해당 옵션의 설정 값의 리스트를 출력합니다. *optname*을 넘긴 경우, 해당 옵션들만 출력합니다. `-p` 옵션은 입력으로 재사용 가능한 형식으로 출력합니다. 이외의 옵션은 다음의 의미를 가집니다.

- **-s**

  각 *optname*을 켭니다(set).
- **-u**

  각 *optname*을 끕니다(unset).
- **-q**

  일반 출력을 억제합니다. 종료 스테이터스는 *optname*이 켜졌는지 꺼졌는지 알려줍니다. 만약 여러 개의 *optname* 인수를 `-q` 와 함게 넘겼다면 모든 *optname*이 켜진다면 종료 스테이터스는 0입니다. 그 이외는 0이 아닌 값입니다.
- **-o**

  *optname*의 값으로 `set` 빌트인의 `-o` 옵션에서 정의된 것만 받습니다([The Set Builtin](chapter_4_3_1.html)을 참조).

`optname` 인수 없이 `-s`나 `-u`를 사용하면, `shopt`는 켜진 옵션 또는 꺼진 옵션만을 각각 보여줍니다.

따로 언급하지 않으면 `shopt`로 지정하는 옵션의 기본 설정은 꺼짐입니다.

옵션 리스트를 출력할 때 모든 `optname`이 켜져있으면 종료 스테이터스는 0입니다. 그 이외의 경우는 0이 아닌 값입니다. 값을 변경하는 경우, `optname`이 잘못된 옵션이 아니라면 종료 스테이터스는 0입니다.

다음은 `shopt`의 옵션 리스트입니다.

- **assoc_expand_once**

  설정했다면, 셸은 산술 표현식 평가할 때와 변수 대입이 발생할 수 있는 빌트인 명령어를 실행할 때, 배열을 역참조하는 빌트인 명령어를 실행할 때 연상 배열의 첨자를 다중 평가하지 않습니다.
- **autocd**

  설정했다면 디렉터리 이름을 명령어 이름으로 실행하면 마치 `cd` 명령어에 인수로 넘겨진 것처럼 행동합니다. 이는 인터랙티브 셸에서만 사용할 수 있습니다
- **cdable_vars**

  설정했다면 `cd` 빌트인 명령어에 디렉터리가 아닌 인수를 넘기면 값에 이동하고 싶은 디렉터리 이름이 들어있는 변수의 이름이라고 인식합니다.
- **cdspell**

  설정했다면 `cd` 명령어에 넘긴 디렉터리 이름의 간단한 철자 미스를 자동으로 수정합니다. 검사하는 에러는 순서가 뒤바뀐 문자, 빠진 문자, 불필요한 문자입니다. 만약 실수가 발견되면, 수정된 경로가 출력되고 명령어가 실행됩니다. 이 옵션은 인터랙티브 셸에서만 사용할 수 있습니다.
- **checkhash**

  설정했다면 Bash는 명령어를 실행하기 전에 해당 명령어가 해시 테이블에 들어있는지 검사합니다. 만약 테이블에 명령어가 존재하지 않는다면, 통상의 경로 검색을 수행합니다.
- **checkjobs**

  설정했다면 Bash는 모든 멈춘, 실행중인 잡의 상태를 인터랙티브 셸이 종료되기 전에 출력합니다. 만약 실행중인 잡이 있다면 별 다른 명령어 실행 없이 한 번 더 종료를 시도했을 때 실제로 종료합니다([Job Control](chapter_7.html)을 참조). 멈춰둔 잡이 있다면 셸은 항상 종료를 연기합니다.
- **checkwinsize**

  설정했다면 Bash는 빌트인이 아닌 각 외부 명령어를 실행하고 윈도우 크기를 검사합니다. 그리고 필요하다면 `LINES`와 `COLUMNS`의 값을 갱신합니다. 이 옵션의 기본 설정은 켜짐입니다.
- **cmdhist**

  설정했다면 Bash는 여러줄로 구성된 명령어의 줄 전체를 하나의 이력으로 저장합니다. 이는 여러줄로 구성된 명령어의 재편집을 간단하게 만들기 위함입니다. 이 옵션의 기본 설정은 켜짐이지만 명령어 이력 기능이 켜져있을 때에만 유효합니다(Bash History Facilites를 참조).
- **compat31**

- **compat32**

- **compat40**

- **compat41**

- **compat42**

- **compat43**

- **compat44**

  이 옵션들은 셸의 호환성 모드([Shell Compatibility Mode](chapter_6_12.html)를 참조)를 제어합니다.
- **complete_fullquote**

  설정했다면 Bash는 완성 기능을 실행할 때 파일 이름과 디렉터리 이름에 포함되어있는 모든 메타 문자를 따옴표로 감쌉니다. 설정하지 않았다면, Bash는 문자 집합으로부터 달러 기호처럼 완성해야할 단어 목록이 들어있는 셸 변수 참조에 들어있는 메타 문자가 있을 때, 완성하면서 따옴표로 감싸야 하는 메타 문자를 제거합니다. 이는 디렉터리 이름으로 전개될 변수 이름의 달러 기호를 따옴표로 감싸지 않는다는 의미입니다. 그러나 파일 이름 중에 존재하는 달러 기호 역시 따옴표로 감싸지 않습니다. 이는 Bash가 완성된 파일 이름을 감싸기 위해서 백슬래시를 사용하는 경우에만 유효합니다. 이 변수의 기본 설정은 켜짐이며, 이는 Bash 4.2까지의 기본 동작이기도 합니다.
- **direxpand**

  설정했다면 Bash는 디렉터리 이름을 파일명 완성을 실행할 때 단어 전개한 결과로 대체합니다. 이는 Readline 편집 버퍼의 내용도 변경합니다. 설정하지 않았다면 Bash는 유저가 입력한 내용을 그대로 유지합니다.
- **dirspell**

  설정했다면 Bash는 단어 완성 처리 중에 주어진 디렉터리 이름을 찾지 못할 경우, 철자 교정을 시도합니다.
- **dotglob**

  설정했다면 Bash는 파일명 전개의 결과에 '.'로 시작하는 파일명을 포함합니다. `dotglob`이 켜져있더라도 파일명 '.'와 '..'은 언제나 명시적으로 일치해야 합니다.
- **execfail**

  설정했다면 논-인터랙티브 셸은 `exec` 빌트인 명령어의 인수로 지정된 파일을 실행하지 못하더라도 종료하지 않습니다. 인터랙티브 셸은 `exec`가 실패하더라도 종료하지 않습니다.
- **expand_aliases**

  설정했다면 별칭은 다음 [Aliases](chapter_6_6.html)에서 설명되는 규칙대로 전개됩니다. 인터랙티브 셸에서 이 옵션의 기본값은 켜짐입니다.
- **extdebug**

  셸을 실행할 때나 셸 기동 파일에서 설정했다면 셸을 시작하기 전에 디버거 프로파일을 실행합니다. 이는 `--debugger` 옵션과 동일합니다. 셸이 실행된 이후에 설정하면 디버거를 사용을 위한 동작이 활성화되며 이는 다음과 같습니다.
  1. `declare` 빌트인(Bash Builtins를 참조)의 `-F` 옵션은 인수로 넘긴 소스 파일명과 각 함수 이름에 대응하는 줄 번호를 출력합니다.
  2. `DEBUG` 트랩으로 실행된 명령어가 0이 아닌 값을 반환하면 다음 명령어는 생략되어 실행되지 않습니다.
  3. `DEBUG` 트랩으로 실행된 명령어가 2고 셸이 서브루틴(셸 함수나 `.`나 `source` 빌트인으로 실행된 셸 스크립트)을 실행중이라면, 셸은 `return`을 호출한 것처럼 동작합니다.
  4. `BASH_ARGC`와 `BASH_ARGV`가 설명에 기술된 대로 갱신됩니다([Bash Variables](chapter_5_2.html)를 참조).
  5. 함수 추적이 유효화됩니다. 명령어 치환, 셸 함수, ( *command* )로 호출된 서브셸은 `DEBUG`와 `RETURN` 트랩을 상속합니다.
  6. 에러 추적이 유효화됩니다. 명령어 치환, 셸 함수, ( *command* )로 호출된 서브셸은 `ERR` 트랩을 상속합니다.
- **extglob**

  설정했다면 위에서 설명한 확장된 패턴 매칭 기능([Pattern Matching](chapter_3_5_8.html#3581-pattern-matching)을 참조)을 켭니다.
- **extquote**

  설정했다면 큰따옴표로 감싼 `${parameter}` 전개 내부의 `$'string'`과 `$"string"`의 감싸기가 실행됩니다. 이 옵션의 기본 설정은 켜짐입니다.
- **failglob**

  설정했다면 파일명 전개중에 패턴 일치에 실패하면 전개 에러를 발생시킵니다.
- **force_fignore**

  설정했다면 `FIGNORE` 셸 변수로 지정한 접미사를 사용하는 단어는 단어 완성을 실행할 때 유일한 완성 후보라고 하더라도 무시합니다. `FIGNORE`의 설명은 [Bash Variables](chapter_5_2.html)를 참조하세요. 이 옵션의 기본값은 켜짐입니다.
- **globasciiranges**

  설정했다면 패턴 매칭의 대괄호에서 사용된 범위 표현식([Pattern Matching](chapter_3_5_8.html#3581-pattern-matching)을 참조)이 값을 비교할 때 전형적인 C 로케일인 것처럼 동작합니다. 현재 로케일의 대조 순서는 고려되지 않으므로 'b'는 'A'와 'B'의 사이에 있지 않으며, ASCII 대문자와 소문자가 따로따로 모입니다.
- **globstar**

  설정했다면, 파일명 전개 컨텍스트에서 사용된 패턴 '\*\*'은 모든 파일과 0개 이상의 디렉터리, 자식 디렉터리와 일치합니다. 만약 패턴 뒤에 '/'가 온다면 디렉터리와 자식 디렉터리만 일치합니다.
- **gnu_errfmt**

  설정했다면 셸의 에러 메시지는 표준 GNU 에러 메시지 형식으로 생성됩니다.
- **histappend**

  설정했다면, 셸이 종료할 때 이력 리스트는 `HISTFILE` 변수에 들어있는 값을 이름으로 하는 파일을 덮어쓰지 않고 말미에 추가됩니다.
- **histreedit**

  Readline을 사용하는 중에 설정했다면 사용자는 실패한 이력 치환을 재수정할 수 있는 기회를 얻을 수 있습니다.
- **histverify**

  Readline을 사용하는 중에 설정했다면 이력 치환의 결과는 즉시 셸 파서로 넘겨지지 않습니다. 그 대신 추가로 수정할 수 있도록 Readline 편집 버퍼로 로딩됩니다.
- **hostcomplete**

  Readline을 사용하는 중에 설정했다면 Bash는 '@'을 포함하는 단어를 완성([Commands For Completion](chapter_8_4_6.html)을 참조)하는 경우, 호스트명 완성을 시도합니다. 이 옵션의 기본 설정은 켜짐입니다.
- **huponexit**

  설정했다면 Bash는 인터랙티브 로그인 셸이 종료할 때 `SIGHUP`을 모든 잡에 전송합니다([Signals](chapter_3_7_6.html)를 참조).
- **inherit_errexit**

  설정했다면, 명령어 치환은 서브셸의 환경에서 `errexit` 옵션을 제거하지 않고 값을 상속합니다. 이 옵션은 POSIX 모드라면 켜집니다.
- **interactive_comments**

  인터랙티브 셸에서 '#'으로 시작하는 단어와 해당 줄의 나머지 모든 문자를 무시합니다. 이 옵션의 기본 설정은 켜짐입니다.
- **lastpipe**

  잡 컨트롤이 활성화되지 않은 상태에서 이 옵션을 설정했다면, 셸은 백그라운드에서 실행되지 않은 파이프라인의 마지막 명령어를 현재 셸 환경에서 실행합니다.
- **lithist**

  `cmdhist` 옵션이 켜져있고, 이 옵션을 설정했다면 여러 줄로 구성된 명령어는 가능하다면 세미콜론 구분자 대신에 개행을 사용하여 이력에 저장합니다.
- **localvar_inherit**

  설정했다면, 지역 변수는 새 값을 대입하기 전까지는 이전 스코프에서 같은 이름을 가진 변수의 값과 속성을 상속합니다. 단, *nameref* 속성은 상속하지 않습니다.
- **localvar_unset**

  설정했다면, 이전 함수 스코프에 존재하던 지역 변수에 `unset`을 호출하면 값을 제거한 것으로 표식을 남기고 이후의 검색에서는 해당 함수가 반환될 때까지 제거된 것으로 취급합니다. 이는 현재 함수 스코프에 있는 지역 변수를 제거하는 동작과 동일합니다.
- **login_shell**

  셸이 로그인 셸로서 기동했을 때([Invoking Bash](chapter_6_1.html)를 참조) 이 옵션을 켭니다. 값은 변경되지 않습니다.
- **mailwarn**

  Bash가 메일을 확인하기 위한 파일에 마지막으로 확인한 이후로 파일에 접근이 있었다면 "the mail in mailfile has been read"를 출력합니다.
- **no_empty_cmd_completion**

  Readline이 사용중이고 이 옵션을 설정했다면 빈 줄에서 완성을 시도할 때, Bash는 가능한 완성을 확인하기 위해 `PATH`를 탐색하지 않습니다.
- **nocaseglob**

  설정했다면 Bash는 일치하는 파일명 전개를 수행할 때 파일명의 대소문자를 구분하지 않습니다.
- **nocasematch**

  설정했다면 Bash는 `case`나 `[[` 조건 명령어, 단어 전개에서의 패턴 치환 중, 프로그래밍 가능한 완성의 일부로 완성의 후보군을 찾을 때의 대소문자를 구분하지 않고 패턴을 검사합니다.
- **nullglob**

  설정했다면 Bash는 어떤 파일에도 일치하지 않는 파일명 패턴을 그대로 두지 않고 널 문자열로 전개합니다.
- **progcomp**

  설정했다면 프로그래밍 가능한 완성 기능([Programmable Completion](chapter_8_6.html)을 참조)을 유효화합니다. 이 옵션의 기본 설정은 켜짐입니다.
- **progcomp_alias**

  프로그래밍 가능한 완성 기능이 켜져있고, 이 옵션을 설정했다면 Bash는 어떤 완성 후보도 없는 명령어의 이름을 별칭으로 판단하고 별칭 전개를 시도합니다. 별칭을 가지고 있다면 Bash는 별칭을 전개한 결과로 얻은 단어를 사용해 프로그래밍 가능한 완성을 시도합니다.
- **promptvars**

  설정했다면, 프롬프트 문자열에 아래에서 설명하는 전개([Controlling the Prompt](chapter_6_9.html)를 참조) 이후에 매개변수 전개, 명령어 치환, 산술 전개, 따옴표 제거가 적용됩니다. 이 옵션의 기본 설정은 켜짐입니다.
- **restricted_shell**

  셸을 한정 모드([The Restricted Shell](chapter_6_10.html)을 참조)로 실행했을 때 셸은 이 옵션을 설정합니다. 값은 변경되지 않습니다. 기동 파일을 실행하더라도 이 값은 리셋되지 않으며, 기동 파일은 셸이 한정 모드인지 아닌지 확인할 수 있습니다.
- **shift_verbose**

  설정했다면, `shift` 빌트인은 위치 매개변수의 개수보다 옮겨야하는 개수가 클 경우 에러 메시지를 출력합니다.
- **sourcepath**

  설정했다면 `source` 빌트인은 인수로 넘긴 파일을 가지고 있는 디렉터리를 찾기 위해서 `PATH` 값을 사용합니다. 이 옵션의 기본 설정은 켜짐입니다.
- **xpg_echo**

  설정했다면 `echo` 빌트인은 백슬래시 이스케이프 문자열을 전개합니다.
